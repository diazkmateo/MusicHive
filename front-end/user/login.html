<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Iniciar Sesión - MusicHive</title>
    <link rel="stylesheet" href="/front-end/main.css">
    <link rel="stylesheet" href="/front-end/user/usuario.css">
</head>
<body>
    <header>
        <h1>MusicHive</h1>
    </header>
    <div class="container">
        <div class="usuario-section">
            <h2>Iniciar Sesión</h2>
            <form id="loginForm" class="usuario-form">
                <div class="form-group">
                    <label for="nombre_usuario">Usuario:</label>
                    <input type="text" id="nombre_usuario" name="nombre_usuario" required>
                </div>
                <div class="form-group">
                    <label for="contrasena">Contraseña:</label>
                    <input type="password" id="contrasena" name="contrasena" required>
                </div>
                <button type="button" id="loginButton">Entrar</button>
            </form>
            <p>¿No tienes cuenta? <a href="register.html">Regístrate aquí</a></p>
            <div id="loginError" style="color:red;"></div>
        </div>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const loginButton = document.getElementById('loginButton');
        
        loginButton.addEventListener('click', async function(e) {
            e.preventDefault(); // Lo dejamos por si acaso, pero ya no es crítico
            
            const nombre_usuario = document.getElementById('nombre_usuario').value;
            const contrasena = document.getElementById('contrasena').value;
            
            const res = await fetch('http://localhost:8000/auth/login', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({nombre_usuario, contrasena})
            });

            if (res.ok) {
                const data = await res.json();
                localStorage.setItem('jwt-token', data.access_token);
                window.location.href = '/front-end/dashboard.html';
            } else {
                document.getElementById('loginError').innerText = 'Usuario o contraseña incorrectos';
            }
        });
    });
    </script>
</body>
</html> 